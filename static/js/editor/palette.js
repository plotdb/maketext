// Generated by LiveScript 1.3.0
$(document).ready(function(){
  var html, i$, to$, i, code, j$, j, d, setPalette, paletteBtn, palette, clusterize;
  html = [];
  for (i$ = 0, to$ = palettes.length; i$ < to$; i$ += 4) {
    i = i$;
    code = "";
    for (j$ = 0; j$ < 4; ++j$) {
      j = j$;
      d = palettes[i + j];
      if (!d) {
        break;
      }
      code += ("<div class=\"palette\"><div class=\"name\">" + d[0] + "</div>") + d[1].map(fn$).join('') + "</div>";
    }
    html.push("<div class='line'>" + code + "</div>");
  }
  window.setPalette = setPalette = function(colors){
    document.querySelector('#palette-btn').innerHTML = colors.map(function(it){
      return "<div class=\"color\" style=\"background:" + it + "\"></div>";
    }).join('');
    return Array.from(document.querySelectorAll("#editor *[data-toggle='colorpicker']")).map(function(d, i){
      var ldcp;
      ldcp = d.getColorPicker();
      ldcp.setPalette({
        colors: colors.map(function(it){
          return {
            hex: it
          };
        })
      });
      return ldcp.setIdx(i % colors.length);
    });
  };
  paletteBtn = document.querySelector('#palette-btn');
  palette = palettes[Math.floor(Math.random() * palettes.length)];
  setPalette(palette[1]);
  /*
  palette-btn.innerHTML = (
    for i from 0 til palette.1.length =>
      "<div class='color' style='background:#{palette.1[i]}'></div>"
  ).join('')
  */
  clusterize = new Clusterize({
    rows: html,
    scrollElem: document.querySelector('#palette-picker .clusterize-scroll'),
    contentElem: document.querySelector('#palette-picker .clusterize-content'),
    rows_in_block: 50
  });
  document.querySelector('#palette-picker').addEventListener('click', function(e){
    var target, colors;
    target = e.target;
    if (!target || !target.classList || !target.classList.contains('palette')) {
      return;
    }
    colors = Array.from(target.querySelectorAll('.color')).map(function(it){
      return it.style.background;
    });
    $('#palette-picker').modal('hide');
    return setPalette(colors);
  });
  return Array.from(document.querySelectorAll('.color input[data-toggle="colorpicker"]')).map(function(d, i){
    var ldcp, name;
    ldcp = d.getColorPicker();
    name = d.getAttribute('name');
    return ldcp.on('change', function(it){
      editor.update(name, it);
      return d.parentNode.querySelector('.inner').style.background = it;
    });
  });
  function fn$(it){
    return "<div class='color' style='background:" + it + "'></div>";
  }
});